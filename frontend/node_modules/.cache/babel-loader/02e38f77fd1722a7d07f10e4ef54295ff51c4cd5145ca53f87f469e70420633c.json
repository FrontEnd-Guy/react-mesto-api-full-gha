{"ast":null,"code":"import _toConsumableArray from\"/Users/paul/Praktikum/dev/mesto-react/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/paul/Praktikum/dev/mesto-react/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import'../index.css';import{api}from\"../utils/API\";import Header from'./Header';import Main from'./Main';import Footer from'./Footer';import ImagePopup from'./ImagePopup';import{EditProfilePopup}from'./EditProfilePopup';import{EditAvatarPopup}from'./EditAvatarPopup';import{AddPlacePopup}from'./AddPlacePopup';import{PopupWithForm}from'./PopupWithForm';import{CurrentUserContext}from'../contexts/CurrentUserContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),currentUser=_useState2[0],setCurrentUser=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isEditProfilePopupOpen=_useState4[0],setEditProfilePopupState=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isAddPlacePopupOpen=_useState6[0],setAddPlacePopupState=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isEditAvatarPopupOpen=_useState8[0],setEditAvatarPopupState=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),selectedCard=_useState10[0],setSelectedCard=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),cards=_useState12[0],setCards=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),isLoading=_useState14[0],setIsLoading=_useState14[1];useEffect(function(){api.getUserInfo().then(function(data){return setCurrentUser(data);}).catch(function(err){return console.log(err);});},[]);useEffect(function(){api.getCardsList().then(function(cards){return setCards(cards);}).catch(function(err){return console.log(err);});},[]);function handleCardLike(card){var isLiked=card.likes.some(function(i){return i._id===currentUser._id;});api.changeLikeCardStatus(card._id,!isLiked).then(function(newCard){setCards(function(state){return state.map(function(c){return c._id===card._id?newCard:c;});});}).catch(function(err){return console.log(err);});}function handleCardClick(card){setSelectedCard(card);}function handleCardDelete(card){api.deleteCard(card._id).then(function(){setCards(function(state){return state.filter(function(c){return c._id!=card._id;});});}).catch(function(err){return console.log(err);});}function handleEditAvatarClick(){setEditAvatarPopupState(true);}function handleEditProfileClick(){setEditProfilePopupState(true);}function handleAddPlaceClick(){setAddPlacePopupState(true);}function closeAllPopups(){setEditAvatarPopupState(false);setAddPlacePopupState(false);setEditProfilePopupState(false);setSelectedCard(null);}var isOpen=isEditAvatarPopupOpen||isEditProfilePopupOpen||isAddPlacePopupOpen||selectedCard;useEffect(function(){function closeByEscape(evt){if(evt.key==='Escape'){closeAllPopups();}}if(isOpen){document.addEventListener('keydown',closeByEscape);return function(){document.removeEventListener('keydown',closeByEscape);};}},[isOpen]);function handleUpdateUser(data){setIsLoading(true);api.editUserInfo(data).then(function(updatedUserInfo){setCurrentUser(updatedUserInfo);closeAllPopups();}).catch(function(err){return console.log(err);}).finally(function(){return setIsLoading(false);});}function handleUpdateAvatar(data){setIsLoading(true);api.updateAvatar(data).then(function(updatedAvater){setCurrentUser(updatedAvater);closeAllPopups();}).catch(function(err){return console.log(err);}).finally(function(){return setIsLoading(false);});}function handleAddPlaceSubmit(data){setIsLoading(true);api.createCard(data).then(function(newCard){setCards([newCard].concat(_toConsumableArray(cards)));closeAllPopups();}).catch(function(err){return console.log(err);}).finally(function(){return setIsLoading(false);});}return/*#__PURE__*/_jsxs(CurrentUserContext.Provider,{value:currentUser,children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(Main,{cards:cards,onCardLike:handleCardLike,onCardDelete:handleCardDelete,onCardClick:handleCardClick,onEditProfile:handleEditProfileClick,onAddPlace:handleAddPlaceClick,onEditAvatar:handleEditAvatarClick}),/*#__PURE__*/_jsx(Footer,{}),/*#__PURE__*/_jsx(ImagePopup,{card:selectedCard,onClose:closeAllPopups}),/*#__PURE__*/_jsx(EditProfilePopup,{isOpen:isEditProfilePopupOpen,onClose:closeAllPopups,onUpdateUser:handleUpdateUser,buttonText:isLoading?'Сохранение...':'Сохранить'}),/*#__PURE__*/_jsx(AddPlacePopup,{isOpen:isAddPlacePopupOpen,onClose:closeAllPopups,onAddPlace:handleAddPlaceSubmit,buttonText:isLoading?'Сохранение...':'Сохранить'}),/*#__PURE__*/_jsx(PopupWithForm,{title:\"\\u0412\\u044B \\u0443\\u0432\\u0435\\u0440\\u0435\\u043D\\u044B?\",name:\"delete-card\",buttonText:\"\\u0414\\u0430\"}),/*#__PURE__*/_jsx(EditAvatarPopup,{isOpen:isEditAvatarPopupOpen,onClose:closeAllPopups,onUpdateAvatar:handleUpdateAvatar,buttonText:isLoading?'Сохранение...':'Сохранить'})]});}export default App;","map":{"version":3,"names":["useState","useEffect","api","Header","Main","Footer","ImagePopup","EditProfilePopup","EditAvatarPopup","AddPlacePopup","PopupWithForm","CurrentUserContext","App","currentUser","setCurrentUser","isEditProfilePopupOpen","setEditProfilePopupState","isAddPlacePopupOpen","setAddPlacePopupState","isEditAvatarPopupOpen","setEditAvatarPopupState","selectedCard","setSelectedCard","cards","setCards","isLoading","setIsLoading","getUserInfo","then","data","catch","err","console","log","getCardsList","handleCardLike","card","isLiked","likes","some","i","_id","changeLikeCardStatus","newCard","state","map","c","handleCardClick","handleCardDelete","deleteCard","filter","handleEditAvatarClick","handleEditProfileClick","handleAddPlaceClick","closeAllPopups","isOpen","closeByEscape","evt","key","document","addEventListener","removeEventListener","handleUpdateUser","editUserInfo","updatedUserInfo","finally","handleUpdateAvatar","updateAvatar","updatedAvater","handleAddPlaceSubmit","createCard"],"sources":["/Users/paul/Praktikum/dev/mesto-react/src/components/App.js"],"sourcesContent":["import {useState, useEffect} from 'react';\nimport '../index.css';\nimport { api } from \"../utils/API\";\nimport Header from './Header';\nimport Main from './Main';\nimport Footer from './Footer';\nimport ImagePopup from './ImagePopup';\nimport { EditProfilePopup } from './EditProfilePopup';\nimport { EditAvatarPopup } from './EditAvatarPopup';\nimport { AddPlacePopup } from './AddPlacePopup';\nimport { PopupWithForm } from './PopupWithForm';\nimport {CurrentUserContext} from '../contexts/CurrentUserContext';\n\nfunction App() {\n  const [currentUser, setCurrentUser] = useState(null);\n  const [isEditProfilePopupOpen, setEditProfilePopupState] = useState(false);\n  const [isAddPlacePopupOpen, setAddPlacePopupState] = useState(false);\n  const [isEditAvatarPopupOpen, setEditAvatarPopupState] = useState(false);\n  const [selectedCard, setSelectedCard] = useState(null);\n  const [cards, setCards] = useState([])\n  const [isLoading, setIsLoading] = useState(false);\n\n\n  useEffect(()=>{\n    api.getUserInfo()\n      .then((data) => setCurrentUser(data))\n      .catch((err) => console.log(err))\n  }, []);\n\n  useEffect(()=>{\n    api.getCardsList()\n        .then((cards) => setCards(cards))\n        .catch((err) => console.log(err))\n  }, []);  \n\n  function handleCardLike(card) {\n    const isLiked = card.likes.some(i => i._id === currentUser._id);\n    api.changeLikeCardStatus(card._id, !isLiked)\n        .then((newCard) => {\n          setCards((state) => state.map((c) => c._id === card._id ? newCard : c));\n        })\n        .catch((err) => console.log(err))\n  }\n\n  function handleCardClick(card) {\n    setSelectedCard(card)\n  }\n\n  function handleCardDelete(card) {\n    api.deleteCard(card._id)    \n        .then(() => {\n          setCards((state) => state.filter((c) => c._id != card._id));\n        })\n        .catch((err) => console.log(err))\n  }\n\n  function handleEditAvatarClick(){\n    setEditAvatarPopupState(true)\n  }\n\n  function handleEditProfileClick(){\n    setEditProfilePopupState(true)\n  }\n\n  function handleAddPlaceClick(){\n    setAddPlacePopupState(true)\n  }\n\n  function closeAllPopups(){\n    setEditAvatarPopupState(false)\n    setAddPlacePopupState(false)\n    setEditProfilePopupState(false)\n    setSelectedCard(null)\n  }\n\n  const isOpen = isEditAvatarPopupOpen || isEditProfilePopupOpen || isAddPlacePopupOpen || selectedCard\n\n  useEffect(() => {\n    function closeByEscape(evt) {\n      if(evt.key === 'Escape') {\n        closeAllPopups();\n      }\n    }\n    if(isOpen) {\n      document.addEventListener('keydown', closeByEscape);\n      return () => {\n        document.removeEventListener('keydown', closeByEscape);\n      }\n    }\n  }, [isOpen]) \n\n  function handleUpdateUser(data){\n    setIsLoading(true);\n    api.editUserInfo(data)\n      .then((updatedUserInfo) =>{\n        setCurrentUser(updatedUserInfo);\n        closeAllPopups();\n      })\n      .catch((err) => console.log(err))\n      .finally(()=>setIsLoading(false))\n  }\n\n  function handleUpdateAvatar(data) {\n    setIsLoading(true);\n    api.updateAvatar(data)\n      .then((updatedAvater) =>{\n        setCurrentUser(updatedAvater);\n        closeAllPopups();\n      })\n      .catch((err) => console.log(err))\n      .finally(()=>setIsLoading(false))\n  }\n\n  function handleAddPlaceSubmit(data) {\n    setIsLoading(true);\n    api.createCard(data)\n      .then((newCard) =>{\n        setCards([newCard, ...cards]);\n        closeAllPopups()\n      })\n      .catch((err) => console.log(err))\n      .finally(()=>setIsLoading(false))\n  }\n\n  return (\n    <CurrentUserContext.Provider value={currentUser}>\n      <Header />\n      <Main \n          cards = {cards}\n          onCardLike = {handleCardLike}\n          onCardDelete = {handleCardDelete}\n          onCardClick = {handleCardClick}\n          onEditProfile = {handleEditProfileClick} \n          onAddPlace = {handleAddPlaceClick} \n          onEditAvatar = {handleEditAvatarClick}/>\n      <Footer />\n      <ImagePopup \n          card={selectedCard} \n          onClose={closeAllPopups}/>\n      <EditProfilePopup \n          isOpen={isEditProfilePopupOpen} \n          onClose={closeAllPopups} \n          onUpdateUser={handleUpdateUser}\n          buttonText={isLoading? 'Сохранение...' : 'Сохранить'}/> \n      <AddPlacePopup \n          isOpen={isAddPlacePopupOpen}\n          onClose={closeAllPopups}\n          onAddPlace={handleAddPlaceSubmit}\n          buttonText={isLoading? 'Сохранение...' : 'Сохранить'}/> \n      <PopupWithForm \n          title = 'Вы уверены?' \n          name = 'delete-card'\n          buttonText = 'Да' />\n      <EditAvatarPopup \n          isOpen={isEditAvatarPopupOpen} \n          onClose={closeAllPopups} \n          onUpdateAvatar={handleUpdateAvatar}\n          buttonText={isLoading? 'Сохранение...' : 'Сохранить'}/>  \n    </CurrentUserContext.Provider>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}